<!DOCTYPE html>
                <html>
                <head>
                
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.css">
                
                
                
                
                <style>
                
                        table, th, td
                        {
                            margin:10px 0;
                            border:solid 1px #333;
                            padding:2px 4px;
                            font:15px Verdana;
                        }
                        th {
                            font-weight:bold;
                        }
                
                //#loader {
                  border: 16px solid #f3f3f3;
                  border-radius: 50%;
                  border-top: 16px solid blue;
                  border-bottom: 16px solid blue;
                  width: 30px;
                  height: 30px;
                  -webkit-animation: spin 2s linear infinite;
                  animation: spin 2s linear infinite;
                  visibility:hidden;
                }
                
                @-webkit-keyframes spin {
                  0% { -webkit-transform: rotate(0deg); }
                  100% { -webkit-transform: rotate(360deg); }
                }
                
                @keyframes spin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
                }
                
                </style>
                <!--script src="cordova.js"></script>-->
                <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
                <script src="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.js"></script>
                
                
                <form >
                
                Select Pile Pipe Number:
                <select id="PipeList" onchange="Test()">
                <option selected="selected">--Please Select--</option>
                <option>T1BP1-A</option>
<option>T1BP1-B</option>
<option>T1BP1-C</option>
<option>T1BP1-D</option>
<option>T1BP2-A</option>
<option>T1BP2-B</option>
<option>T1BP2-C</option>
<option>T1BP2-D</option>
<option>T1BP3A-A</option>
<option>T1BP3A-B</option>
<option>T1BP3A-C</option>
<option>T1BP3A-D</option>
<option>T1BP3B-A</option>
<option>T1BP3B-B</option>
<option>T1BP3B-C</option>
<option>T1BP3B-D</option>
<option>T1BP4-A</option>
<option>T1BP4-B</option>
<option>T1BP4-C</option>
<option>T1BP4-D</option>
<option>T1BP5-A</option>
<option>T1BP5-B</option>
<option>T1BP5-C</option>
<option>T1BP5-D</option>
<option>T1BP6-A</option>
<option>T1BP6-B</option>
<option>T1BP6-C</option>
<option>T1BP6-D</option>
<option>T1BP7A-A</option>
<option>T1BP7A-B</option>
<option>T1BP7A-C</option>
<option>T1BP7A-D</option>
<option>T1BP7B-A</option>
<option>T1BP7B-B</option>
<option>T1BP7B-C</option>
<option>T1BP7B-D</option>
<option>T1BP8-A</option>
<option>T1BP8-B</option>
<option>T1BP8-C</option>
<option>T1BP8-D</option>
<option>T1BP9-A</option>
<option>T1BP9-B</option>
<option>T1BP9-C</option>
<option>T1BP9-D</option>
<option>T2BP1-A</option>
<option>T2BP1-B</option>
<option>T2BP1-C</option>
<option>T2BP1-D</option>
<option>T2BP2-A</option>
<option>T2BP2-B</option>
<option>T2BP2-C</option>
<option>T2BP2-D</option>
<option>T2BP3-A</option>
<option>T2BP3-B</option>
<option>T2BP3-C</option>
<option>T2BP3-D</option>
<option>T2BP4-A</option>
<option>T2BP4-B</option>
<option>T2BP4-C</option>
<option>T2BP4-D</option>
<option>T2BP5-A</option>
<option>T2BP5-B</option>
<option>T2BP5-C</option>
<option>T2BP5-D</option>
<option>T2BP6-A</option>
<option>T2BP6-B</option>
<option>T2BP6-C</option>
<option>T2BP6-D</option>
<option>T2BP7-A</option>
<option>T2BP7-B</option>
<option>T2BP7-C</option>
<option>T2BP7-D</option>
<option>T2BP8-A</option>
<option>T2BP8-B</option>
<option>T2BP8-C</option>
<option>T2BP8-D</option>
<option>T2BP9-A</option>
<option>T2BP9-B</option>
<option>T2BP9-C</option>
<option>T2BP9-D</option>
<option>T2BP10-A</option>
<option>T2BP10-B</option>
<option>T2BP10-C</option>
<option>T2BP10-D</option>
<option>T2BP11-A</option>
<option>T2BP11-B</option>
<option>T2BP11-C</option>
<option>T2BP11-D</option>
<option>T3BP1-A</option>
<option>T3BP1-B</option>
<option>T3BP1-C</option>
<option>T3BP1-D</option>
<option>T3BP2-A</option>
<option>T3BP2-B</option>
<option>T3BP2-C</option>
<option>T3BP2-D</option>
<option>T3BP3-A</option>
<option>T3BP3-B</option>
<option>T3BP3-C</option>
<option>T3BP3-D</option>
<option>T3BP4-A</option>
<option>T3BP4-B</option>
<option>T3BP4-C</option>
<option>T3BP4-D</option>
<option>T3BP5-A</option>
<option>T3BP5-B</option>
<option>T3BP5-C</option>
<option>T3BP5-D</option>
<option>T3BP6-A</option>
<option>T3BP6-B</option>
<option>T3BP6-C</option>
<option>T3BP6-D</option>
<option>T3BP7-A</option>
<option>T3BP7-B</option>
<option>T3BP7-C</option>
<option>T3BP7-D</option>
<option>T3BP8-A</option>
<option>T3BP8-B</option>
<option>T3BP8-C</option>
<option>T3BP8-D</option>
<option>T3BP9-A</option>
<option>T3BP9-B</option>
<option>T3BP9-C</option>
<option>T3BP9-D</option>
<option>T3BP10-A</option>
<option>T3BP10-B</option>
<option>T3BP10-C</option>
<option>T3BP10-D</option>
<option>T3BP11-A</option>
<option>T3BP11-B</option>
<option>T3BP11-C</option>
<option>T3BP11-D</option>
<option>T3BP12-A</option>
<option>T3BP12-B</option>
<option>T3BP12-C</option>
<option>T3BP12-D</option>
<option>T3BP13-A</option>
<option>T3BP13-B</option>
<option>T3BP13-C</option>
<option>T3BP13-D</option>
<option>T3BP14-A</option>
<option>T3BP14-B</option>
<option>T3BP14-C</option>
<option>T3BP14-D</option>
<option>T3BP15-A</option>
<option>T3BP15-B</option>
<option>T3BP15-C</option>
<option>T3BP15-D</option>
                
                
                
                </select>
                
                <name ="name" id="name">
                
                
                </form>
                <br>
                
                <input type="button" onclick="update_value()" value="Read" />
                <!--<input type="button" onclick="read_value()" value="Read" />-->
                <!--<a href="https://docs.google.com/spreadsheets/d/1_LNyU2DB0Tg3caKA7klePACWOgASbek4I5LqOysxFaY/edit?usp=sharing" rel="external">Click here to open Spread Sheet </a>-->
                <div id="showData" align="center"></div>
                </div>
                
                
                <script>
                
                  var script_url = "https://script.google.com/macros/s/AKfycbwNLT8dALqnuqXB8-i_ANCCyssf3Kw22AcqEIOTmcVkP4GekBI/exec";
                
                  // Make an AJAX call to Google Script
                
                
                
                
                
                
                
                  function update_value(){
                                $("#re").css("visibility","hidden");
                     document.getElementById("loader").style.visibility = "visible";
                
                
                var id1=                $("#id").val();
                                var name= $("#name").val();
                
                
                
                    var url = script_url+"?callback=ctrlq&name="+name+"&id="+id1+"&action=update";
                
                
                    var request = jQuery.ajax({
                      crossDomain: true,
                      url: url ,
                      method: "GET",
                      dataType: "jsonp"
                    });
                
                
                  }
                
                
                
                
                
                
                
                
                
                
                  // print the returned data
                  function ctrlq(e) {
                
                
                                $("#re").html(e.result);
                                $("#re").css("visibility","visible");
                                read_value();
                
                  }
                
                
                
                
                function read_value() {
                
                $("#re").css("visibility","hidden");
                
                   document.getElementById("loader").style.visibility = "visible";
                var url = script_url+"?action=read";
                
                $.getJSON(url, function (json) {
                
                    // Set the variables from the results array
                
                
                
                
                        // CREATE DYNAMIC TABLE.
                        var table = document.createElement("table");
                
                
                
                        var header = table.createTHead();
                        var row = header.insertRow(0);
                                                var cell1 = row.insertCell(0);
                                                var cell2 = row.insertCell(1);
                                                cell1.innerHTML = "<b>Item</b>";
                                                cell2.innerHTML = "<b>Data</b>";
                
                        // ADD JSON DATA TO THE TABLE AS ROWS.
                        for (var i = 0; i < json.records.length; i++) {
                
                            tr = table.insertRow(-1);
                                                                                var tabCell = tr.insertCell(-1);
                                tabCell.innerHTML = json.records[i].Heading;
                                                                                tabCell = tr.insertCell(-1);
                                                                                tabCell.innerHTML = json.records[i].Information;
                            }
                
                
                        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
                        var divContainer = document.getElementById("showData");
                        divContainer.innerHTML = "";
                        divContainer.appendChild(table);
                                                document.getElementById("loader").style.visibility = "hidden";
                                                $("#re").css("visibility","visible");
                    });
                                }
                
                
                function Test()
                {
                var PipeList=document.getElementById("PipeList");
                document.getElementById("name").value=PipeList.options[PipeList.selectedIndex].text;
                }
                
                  </script>
                
                
                
                
                </head>
                <body>
                
                
                
                <div id="loader"></div>
                
                <p id="re"></p>
                
                
                
                </body>
                
                
                
                <div align="center">
                <p> | All Rights Reserved |</p>
                </div>
                <html>
